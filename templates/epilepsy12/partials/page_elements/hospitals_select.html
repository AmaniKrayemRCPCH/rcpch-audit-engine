{% comment %}
This partial template is a dropdown of all the hospital trusts
It relies on a little bit of jquery unfortunately because that is semantic-ui
Parameters:
hx_name: [paediatric_neurology_centre, epilepsy_surgery_centre]
hx_url: the url complete with parameters to POST
label: received from the parent - text for the button
hx_target: the id of the html element to be replaced 
hx_default_text: placeholder text for the search select dropdown
hx_post: url to post to
hospital_list: a filtered list of hospitals
test_positive: currently selected hospital id
enabled: boolean
{% endcomment %}

<div class="field" hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
    <span>
            
        {% comment %} {% if test_positive %}
            <i class="rcpch_pink check circle outline icon"></i>
        {% else %}{% endcomment %}
        <span data-tooltip="Uncompleted field. This must be scored to complete the record." data-inverted="" data-position="top left">
            <i class="rcpch_light_blue dot circle outline icon"></i>
        </span>
        
        {% if enabled %}
            <div class="ui rcpch_light_blue search selection dropdown">
        {% else %}
            <div class="ui rcpch_light_blue search selection disabled dropdown">    
        {% endif %}
                <i class="dropdown icon"></i>
                <input type="hidden" 
                    hx-post="{{hx_post}}"
                    hx-target="{{hx_target}}"
                    hx-swap="{{hx_swap}}"
                    hx-trigger="{{hx_trigger}}"
                    name='{{hx_name}}'
                    value="{{test_positive}}"
                    _="init js $('.ui.rcpch_light_blue.search.selection.dropdown').dropdown(); end"
                >
                <div class="default text">{{hx_default_text}}</div>
                <div class="menu" >
                    {% for item in hospital_list %}
                        <div class="item" data-value="{{item.pk}}" >{{item.OrganisationName}}</div>
                    {% endfor %}
                </div>
            </div>
            <div class='ui buttons'>
                <button 
                class="ui rcpch_primary button"
                hx-post="{{hx_post}}"
                hx-target="{{hx_target}}"
                hx-swap="innerHTML"
                hx-trigger="click"
                name='hospital_allocate_button'
                >{{label}}</button>

                <button 
                    class="ui rcpch_cancel button"
                    hx-post="{{hx_cancel}}"
                    hx-target="{{hx_target}}"
                    hx-swap="innerHTML"
                    hx-trigger="click"
                >Cancel</button>
            </div>
            
        </span>
        
    </div>
    {% if not enabled %}
        <small class='rcpch_warning_label'>You do not have permission to update this field</small>
    {% endif %}